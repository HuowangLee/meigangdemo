import{p as le,r as se,q as ae,k as ne,t as F,h as C,j as oe}from"./element-b9b1fa5e.js";import{_ as ie}from"./index-cb2b234a.js";import{l as de,r as h,c as R,m as ue,al as u,z as _,A as T,B as s,R as t,J as l,u as y,O as d,P as r,I as V,M as I,Q as re,a4 as ce}from"./vendor-f95dc610.js";const pe={class:"ai-suggestions"},fe={class:"filter-section"},me={class:"suggestions-list"},_e={class:"suggestion-summary"},ge={class:"summary-title"},ve={class:"summary-content"},ye={class:"confidence-display"},be={class:"confidence-text"},xe={class:"profit-value"},ke={class:"reconciliation-section"},Ce={class:"reconciliation-card"},Ve={class:"card-header"},Ie={class:"card-content"},we={class:"improvement"},Se={class:"reconciliation-card"},he={class:"card-header"},Ae={class:"card-content"},Fe={class:"improvement"},Te={class:"reconciliation-card"},Ee={class:"card-header"},Pe={class:"card-content"},Re={class:"improvement"},ze={key:0,class:"suggestion-detail"},Me={class:"detail-content"},je={class:"detail-content"},Be={class:"detail-content"},$e={__name:"AISuggestions",setup(Ue){const o=de({furnace:"",shift:"",status:"",confidence:"",dateRange:[],keyword:""}),z=h([{id:1,furnaceId:"F001",stage:"主吹期",title:"建议增加石灰用量",summary:"根据当前渣系分析，建议增加石灰用量以提高脱磷效果",type:"材料调整",confidence:85,expectedProfit:1200,status:"pending",createTime:"2024-01-15 14:20",details:"当前渣碱度偏低，建议增加石灰50kg，预计可提高脱磷效率15%，降低终点P含量0.002%",expectedEffect:"提高脱磷效率，降低P含量波动",executionRecords:[{time:"14:20",action:"AI生成建议",operator:"系统",type:"primary"},{time:"14:22",action:"建议审核",operator:"工艺员",type:"success"}]},{id:2,furnaceId:"F002",stage:"终点调整",title:"建议调整氧流量",summary:"根据温度预测，建议降低氧流量以避免过吹",type:"工艺调整",confidence:92,expectedProfit:800,status:"executing",createTime:"2024-01-15 14:15",details:"当前温度预测偏高，建议将氧流量从8000降至7500m³/h，避免过吹导致温度超标",expectedEffect:"避免过吹，提高终点命中率",executionRecords:[{time:"14:15",action:"AI生成建议",operator:"系统",type:"primary"},{time:"14:17",action:"建议通过",operator:"操作员",type:"success"},{time:"14:18",action:"开始执行",operator:"操作员",type:"warning"}]},{id:3,furnaceId:"F003",stage:"装料",title:"建议调整装料配比",summary:"根据历史数据，建议调整铁水废钢配比以提高终点命中率",type:"配比优化",confidence:78,expectedProfit:1500,status:"completed",createTime:"2024-01-15 13:45",details:"建议将铁水比例从85%调整至87%，废钢比例从15%调整至13%，预计可提高温度命中率3%",expectedEffect:"提高温度命中率，减少终点调整时间",executionRecords:[{time:"13:45",action:"AI生成建议",operator:"系统",type:"primary"},{time:"13:47",action:"建议通过",operator:"操作员",type:"success"},{time:"13:48",action:"开始执行",operator:"操作员",type:"warning"},{time:"14:00",action:"执行完成",operator:"操作员",type:"success"}]},{id:4,furnaceId:"F001",stage:"取样",title:"建议延迟取样时间",summary:"根据当前反应状态，建议延迟2分钟取样以获得更准确的结果",type:"时间调整",confidence:65,expectedProfit:600,status:"rejected",createTime:"2024-01-15 14:10",details:"当前反应尚未完全稳定，建议延迟取样时间2分钟，以获得更准确的成分数据",expectedEffect:"提高取样准确性，减少复测次数",executionRecords:[{time:"14:10",action:"AI生成建议",operator:"系统",type:"primary"},{time:"14:12",action:"建议拒绝",operator:"操作员",type:"danger"}]}]),x=h([]),w=h(!1),c=h(null),M=R(()=>z.value.filter(n=>{var e;if(o.furnace&&n.furnaceId!==o.furnace||o.shift&&!((e=n.shift)!=null&&e.includes(o.shift))||o.status&&n.status!==o.status)return!1;if(o.confidence){const i=n.confidence;if(o.confidence==="high"&&i<80||o.confidence==="medium"&&(i<60||i>=80)||o.confidence==="low"&&i>=60)return!1}return!(o.keyword&&!n.summary.toLowerCase().includes(o.keyword.toLowerCase()))})),j=R(()=>x.value.length>0),B=()=>{C.success("数据已刷新")},$=()=>{Object.keys(o).forEach(n=>{o[n]=n==="dateRange"?[]:""})},U=n=>{x.value=n},D=()=>{C.success(`已批量通过 ${x.value.length} 条建议`),x.value.forEach(n=>{n.status="executing"}),x.value=[]},E=n=>{n.status="executing",C.success("建议已通过")},N=n=>{oe.prompt("请输入拒绝原因","拒绝建议",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(({value:e})=>{n.status="rejected",n.rejectReason=e,C.success("建议已拒绝")})},L=n=>{n.status="completed",C.success("建议执行完成")},O=n=>{c.value=n,w.value=!0},q=n=>({装料:"info",主吹期:"warning",终点调整:"danger",取样:"primary"})[n]||"info",J=n=>({pending:"warning",executing:"primary",completed:"success",rejected:"danger"})[n]||"info",Q=n=>({pending:"待执行",executing:"执行中",completed:"已完成",rejected:"已拒绝"})[n]||n,G=n=>n>=80?"#67C23A":n>=60?"#E6A23C":"#F56C6C";return ue(()=>{console.log("AI建议队列页面已加载")}),(n,e)=>{var P;const i=u("el-option"),S=u("el-select"),p=u("el-col"),A=u("el-row"),H=u("el-date-picker"),g=u("el-icon"),K=u("el-input"),f=u("el-button"),m=u("el-table-column"),k=u("el-tag"),W=u("el-progress"),X=u("el-table"),b=u("el-descriptions-item"),Y=u("el-descriptions"),Z=u("el-timeline-item"),ee=u("el-timeline"),te=u("el-dialog");return _(),T("div",pe,[s("div",fe,[t(A,{gutter:20},{default:l(()=>[t(p,{span:6},{default:l(()=>[t(S,{modelValue:o.furnace,"onUpdate:modelValue":e[0]||(e[0]=a=>o.furnace=a),placeholder:"选择炉次",clearable:""},{default:l(()=>[t(i,{label:"全部炉次",value:""}),t(i,{label:"F001",value:"F001"}),t(i,{label:"F002",value:"F002"}),t(i,{label:"F003",value:"F003"})]),_:1},8,["modelValue"])]),_:1}),t(p,{span:6},{default:l(()=>[t(S,{modelValue:o.shift,"onUpdate:modelValue":e[1]||(e[1]=a=>o.shift=a),placeholder:"选择班次",clearable:""},{default:l(()=>[t(i,{label:"全部班次",value:""}),t(i,{label:"白班",value:"day"}),t(i,{label:"中班",value:"middle"}),t(i,{label:"夜班",value:"night"})]),_:1},8,["modelValue"])]),_:1}),t(p,{span:6},{default:l(()=>[t(S,{modelValue:o.status,"onUpdate:modelValue":e[2]||(e[2]=a=>o.status=a),placeholder:"选择状态",clearable:""},{default:l(()=>[t(i,{label:"全部状态",value:""}),t(i,{label:"待执行",value:"pending"}),t(i,{label:"执行中",value:"executing"}),t(i,{label:"已完成",value:"completed"}),t(i,{label:"已拒绝",value:"rejected"})]),_:1},8,["modelValue"])]),_:1}),t(p,{span:6},{default:l(()=>[t(S,{modelValue:o.confidence,"onUpdate:modelValue":e[3]||(e[3]=a=>o.confidence=a),placeholder:"置信度范围",clearable:""},{default:l(()=>[t(i,{label:"全部",value:""}),t(i,{label:"高(≥80%)",value:"high"}),t(i,{label:"中(60-80%)",value:"medium"}),t(i,{label:"低(<60%)",value:"low"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(A,{gutter:20,style:{"margin-top":"15px"}},{default:l(()=>[t(p,{span:6},{default:l(()=>[t(H,{modelValue:o.dateRange,"onUpdate:modelValue":e[4]||(e[4]=a=>o.dateRange=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),t(p,{span:6},{default:l(()=>[t(K,{modelValue:o.keyword,"onUpdate:modelValue":e[5]||(e[5]=a=>o.keyword=a),placeholder:"搜索建议内容",clearable:""},{prefix:l(()=>[t(g,null,{default:l(()=>[t(y(le))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(p,{span:6},{default:l(()=>[t(f,{type:"primary",onClick:B},{default:l(()=>[t(g,null,{default:l(()=>[t(y(se))]),_:1}),e[9]||(e[9]=d(" 刷新 ",-1))]),_:1}),t(f,{onClick:$},{default:l(()=>[t(g,null,{default:l(()=>[t(y(ae))]),_:1}),e[10]||(e[10]=d(" 重置 ",-1))]),_:1})]),_:1}),t(p,{span:6},{default:l(()=>[t(f,{type:"success",onClick:D,disabled:!j.value},{default:l(()=>[t(g,null,{default:l(()=>[t(y(ne))]),_:1}),e[11]||(e[11]=d(" 批量审批 ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),s("div",me,[t(X,{data:M.value,onSelectionChange:U,stripe:"",style:{width:"100%"}},{default:l(()=>[t(m,{type:"selection",width:"55"}),t(m,{prop:"furnaceId",label:"炉次",width:"80"}),t(m,{prop:"stage",label:"阶段",width:"100"},{default:l(({row:a})=>[t(k,{type:q(a.stage),size:"small"},{default:l(()=>[d(r(a.stage),1)]),_:2},1032,["type"])]),_:1}),t(m,{prop:"summary",label:"建议摘要","min-width":"200"},{default:l(({row:a})=>[s("div",_e,[s("div",ge,r(a.title),1),s("div",ve,r(a.summary),1)])]),_:1}),t(m,{prop:"confidence",label:"置信度",width:"100"},{default:l(({row:a})=>[s("div",ye,[t(W,{percentage:a.confidence,color:G(a.confidence),"show-text":!1,"stroke-width":6},null,8,["percentage","color"]),s("span",be,r(a.confidence)+"%",1)])]),_:1}),t(m,{prop:"expectedProfit",label:"预计收益",width:"120"},{default:l(({row:a})=>[s("span",xe,"¥"+r(a.expectedProfit),1)]),_:1}),t(m,{prop:"status",label:"状态",width:"100"},{default:l(({row:a})=>[t(k,{type:J(a.status),size:"small"},{default:l(()=>[d(r(Q(a.status)),1)]),_:2},1032,["type"])]),_:1}),t(m,{prop:"createTime",label:"创建时间",width:"150"}),t(m,{label:"操作",width:"200",fixed:"right"},{default:l(({row:a})=>[a.status==="pending"?(_(),V(f,{key:0,type:"primary",size:"small",onClick:v=>E(a)},{default:l(()=>[...e[12]||(e[12]=[d(" 通过 ",-1)])]),_:1},8,["onClick"])):I("",!0),a.status==="pending"?(_(),V(f,{key:1,type:"danger",size:"small",onClick:v=>N(a)},{default:l(()=>[...e[13]||(e[13]=[d(" 驳回 ",-1)])]),_:1},8,["onClick"])):I("",!0),a.status==="executing"?(_(),V(f,{key:2,type:"success",size:"small",onClick:v=>L(a)},{default:l(()=>[...e[14]||(e[14]=[d(" 完成 ",-1)])]),_:1},8,["onClick"])):I("",!0),t(f,{size:"small",onClick:v=>O(a)},{default:l(()=>[...e[15]||(e[15]=[d(" 详情 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),s("div",ke,[e[31]||(e[31]=s("h3",null,"事后对账",-1)),t(A,{gutter:20},{default:l(()=>[t(p,{span:8},{default:l(()=>[s("div",Ce,[s("div",Ve,[e[17]||(e[17]=s("h4",null,"命中率提升",-1)),t(k,{type:"success",size:"small"},{default:l(()=>[...e[16]||(e[16]=[d("+2.3%",-1)])]),_:1})]),s("div",Ie,[e[19]||(e[19]=s("div",{class:"metric"},[s("span",{class:"label"},"优化前："),s("span",{class:"value"},"95.2%")],-1)),e[20]||(e[20]=s("div",{class:"metric"},[s("span",{class:"label"},"优化后："),s("span",{class:"value"},"97.5%")],-1)),s("div",we,[t(g,null,{default:l(()=>[t(y(F))]),_:1}),e[18]||(e[18]=s("span",null,"AI建议执行后命中率显著提升",-1))])])])]),_:1}),t(p,{span:8},{default:l(()=>[s("div",Se,[s("div",he,[e[22]||(e[22]=s("h4",null,"P波动降低",-1)),t(k,{type:"success",size:"small"},{default:l(()=>[...e[21]||(e[21]=[d("-37.5%",-1)])]),_:1})]),s("div",Ae,[e[24]||(e[24]=s("div",{class:"metric"},[s("span",{class:"label"},"优化前："),s("span",{class:"value"},"±0.0048%")],-1)),e[25]||(e[25]=s("div",{class:"metric"},[s("span",{class:"label"},"优化后："),s("span",{class:"value"},"±0.0030%")],-1)),s("div",Fe,[t(g,null,{default:l(()=>[t(y(F))]),_:1}),e[23]||(e[23]=s("span",null,"脱磷控制更加稳定",-1))])])])]),_:1}),t(p,{span:8},{default:l(()=>[s("div",Te,[s("div",Ee,[e[27]||(e[27]=s("h4",null,"药剂节约",-1)),t(k,{type:"success",size:"small"},{default:l(()=>[...e[26]||(e[26]=[d("-6.8%",-1)])]),_:1})]),s("div",Pe,[e[29]||(e[29]=s("div",{class:"metric"},[s("span",{class:"label"},"石灰节约："),s("span",{class:"value"},"45kg/炉")],-1)),e[30]||(e[30]=s("div",{class:"metric"},[s("span",{class:"label"},"萤石节约："),s("span",{class:"value"},"8kg/炉")],-1)),s("div",Re,[t(g,null,{default:l(()=>[t(y(F))]),_:1}),e[28]||(e[28]=s("span",null,"原料成本显著降低",-1))])])])]),_:1})]),_:1})]),t(te,{modelValue:w.value,"onUpdate:modelValue":e[8]||(e[8]=a=>w.value=a),title:`建议详情 - ${(P=c.value)==null?void 0:P.furnaceId}`,width:"800px"},{footer:l(()=>{var a;return[t(f,{onClick:e[6]||(e[6]=v=>w.value=!1)},{default:l(()=>[...e[35]||(e[35]=[d("关闭",-1)])]),_:1}),((a=c.value)==null?void 0:a.status)==="pending"?(_(),V(f,{key:0,type:"primary",onClick:e[7]||(e[7]=v=>E(c.value))},{default:l(()=>[...e[36]||(e[36]=[d(" 通过建议 ",-1)])]),_:1})):I("",!0)]}),default:l(()=>[c.value?(_(),T("div",ze,[t(Y,{column:2,border:""},{default:l(()=>[t(b,{label:"炉次ID"},{default:l(()=>[d(r(c.value.furnaceId),1)]),_:1}),t(b,{label:"当前阶段"},{default:l(()=>[d(r(c.value.stage),1)]),_:1}),t(b,{label:"建议类型"},{default:l(()=>[d(r(c.value.type),1)]),_:1}),t(b,{label:"置信度"},{default:l(()=>[d(r(c.value.confidence)+"%",1)]),_:1}),t(b,{label:"预计收益"},{default:l(()=>[d("¥"+r(c.value.expectedProfit),1)]),_:1}),t(b,{label:"创建时间"},{default:l(()=>[d(r(c.value.createTime),1)]),_:1})]),_:1}),s("div",Me,[e[32]||(e[32]=s("h4",null,"建议详情",-1)),s("p",null,r(c.value.details),1)]),s("div",je,[e[33]||(e[33]=s("h4",null,"预期效果",-1)),s("p",null,r(c.value.expectedEffect),1)]),s("div",Be,[e[34]||(e[34]=s("h4",null,"执行记录",-1)),t(ee,null,{default:l(()=>[(_(!0),T(re,null,ce(c.value.executionRecords,(a,v)=>(_(),V(Z,{key:v,timestamp:a.time,type:a.type},{default:l(()=>[d(r(a.action)+" - "+r(a.operator),1)]),_:2},1032,["timestamp","type"]))),128))]),_:1})])])):I("",!0)]),_:1},8,["modelValue","title"])])}}},Oe=ie($e,[["__scopeId","data-v-62b4e181"]]);export{Oe as default};
