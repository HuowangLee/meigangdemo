import{aB as xe,r as u,l as ye,c as he,m as Ce,U as be,al as d,z as m,A as _,B as t,P as o,R as l,J as s,u as y,O as c,Q as ke,a4 as Me,M as F,D as Ae,I as S}from"./vendor-f95dc610.js";import{u as we,i as Re,a as Te,c as Ie,d as Ve,e as Fe,f as Se,g as ze,H as Be}from"./echarts-a243c330.js";import{h,b as Pe,a as De,g as Ee,j as Oe,k as $e,l as Ne,n as Ue}from"./element-b9b1fa5e.js";import{_ as Le}from"./index-cb2b234a.js";const je={class:"furnace-realtime"},Ge={class:"furnace-header"},Qe={class:"furnace-info"},We={class:"furnace-details"},qe={class:"furnace-actions"},He={class:"timeline-section"},Je={class:"timeline"},Ze={class:"timeline-marker"},Ke={class:"timeline-content"},Xe={class:"event-title"},Ye={class:"event-time"},et={key:0,class:"event-details"},tt={class:"realtime-charts"},lt={class:"ai-suggestions-panel"},st={key:0,class:"suggestion-card"},at={class:"suggestion-header"},nt={class:"suggestion-title"},ot={class:"suggestion-content"},it={class:"suggestion-details"},rt={class:"detail-item"},ut={class:"detail-item"},dt={class:"detail-item"},ct={class:"profit"},mt={class:"suggestion-actions"},pt={key:1,class:"no-suggestion"},vt={class:"target-windows"},_t={class:"target-item"},gt={class:"target-range"},ft={class:"current-value"},xt={class:"target-item"},yt={class:"target-range"},ht={class:"current-value"},Ct={class:"target-item"},bt={class:"target-range"},kt={class:"current-value"},Mt={key:0,class:"countdown-reminder"},At={class:"material-wizard"},wt={key:0,class:"wizard-result"},Rt={class:"result-item"},Tt={__name:"FurnaceRealtime",setup(It){we([Re,Te,Ie,Ve,Fe,Se,ze]);const P=xe(),D=u(P.query.id||"F001"),E=u("主吹期"),O=u("Q235B"),$=u("14:00"),N=u("14:28"),U=u([{title:"装料开始",time:"14:00",completed:!0,active:!1,details:"铁水120t，废钢15t，石灰2.5t"},{title:"吹炼开始",time:"14:03",completed:!0,active:!1,details:"氧流量8500m³/h，枪位1.8m"},{title:"主吹期",time:"14:08",completed:!1,active:!0,details:"当前阶段，脱碳反应剧烈"},{title:"取样",time:"14:22",completed:!1,active:!1,details:"预计取样时间，检测C、P含量"},{title:"终点调整",time:"14:25",completed:!1,active:!1,details:"根据取样结果调整温度"},{title:"出钢",time:"14:28",completed:!1,active:!1,details:"预计出钢时间"}]),C=u(1675),b=u(.12),k=u(3.1),g=u({min:1650,max:1700}),f=u({min:.05,max:.15}),x=u({min:3,max:3.5}),p=u({title:"建议调整氧流量",description:"根据当前温度趋势，建议降低氧流量避免过吹",content:"氧流量 8500→8000m³/h",expectedEffect:"避免过吹，提高终点命中率",expectedProfit:1500,confidence:88}),M=u(0),A=u(!1),v=ye({limeStock:8500,targetR:3.1,constraints:["lime"]}),w=u(null);function L(){const i=[],e=new Date;for(let a=0;a<20;a++){const n=new Date(e.getTime()-(19-a)*6e4);i.push(n.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}))}return i}function j(){return Array.from({length:20},(i,e)=>{const a=e/19;let n=1650;return a<.3?n=1650+a*20:a<.8?n=1660+(a-.3)*40:n=1680+(a-.8)*10,Math.round(n+(Math.random()-.5)*8)})}function G(){return Array.from({length:20},(i,e)=>{const n=.4-e/19*.35;return Math.round((n+(Math.random()-.5)*.02)*1e3)/1e3})}function Q(){return Array.from({length:20},(i,e)=>{const n=2.8+e/19*.4;return Math.round((n+(Math.random()-.5)*.1)*10)/10})}function W(){return Array.from({length:20},(i,e)=>{const a=e/19;let n=12;return a<.6?n=12+a*8:n=20-(a-.6)*5,Math.round(n+(Math.random()-.5)*2)})}function q(){return Array.from({length:20},(i,e)=>Math.round(8500+(Math.random()-.5)*300))}function H(){return Array.from({length:20},(i,e)=>{const n=1.8-e/19*.3;return Math.round((n+(Math.random()-.5)*.1)*10)/10})}const J=he(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:["温度","碳含量","渣碱度","FeO","氧流量","枪位"]},xAxis:{type:"category",data:L()},yAxis:[{type:"value",name:"温度(°C)",position:"left"},{type:"value",name:"其他",position:"right"}],series:[{name:"温度",type:"line",yAxisIndex:0,data:j(),smooth:!0,itemStyle:{color:"#F56C6C"}},{name:"碳含量",type:"line",yAxisIndex:1,data:G(),smooth:!0,itemStyle:{color:"#409EFF"}},{name:"渣碱度",type:"line",yAxisIndex:1,data:Q(),smooth:!0,itemStyle:{color:"#67C23A"}},{name:"FeO",type:"line",yAxisIndex:1,data:W(),smooth:!0,itemStyle:{color:"#E6A23C"}},{name:"氧流量",type:"line",yAxisIndex:1,data:q(),smooth:!0,itemStyle:{color:"#909399"}},{name:"枪位",type:"line",yAxisIndex:1,data:H(),smooth:!0,itemStyle:{color:"#9C27B0"}}],dataZoom:[{type:"inside",start:70,end:100}]})),Z=()=>{h.success("取样指令已发送"),M.value=5},K=()=>{h.success("测温指令已发送")},X=()=>{A.value=!0,Y()},Y=()=>{const e=v.targetR,a=Math.round((e-3.1)*200+100),n=Math.round(a*.12);w.value={lime:a,fluorite:n,expectedR:e}},ee=()=>{h.success("加料方案已执行"),A.value=!1},te=()=>{h.success("AI建议已执行"),p.value=null},le=()=>{h.info("部分执行AI建议")},se=()=>{Oe.prompt("请输入拒绝原因","拒绝AI建议",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(({value:i})=>{h.success("已拒绝AI建议"),p.value=null})},ae=i=>i>=80?"success":i>=60?"warning":"danger",ne=()=>{const i=g.value.max-g.value.min,e=(C.value-g.value.min)/i;return Math.max(0,Math.min(100,e*100))},oe=()=>C.value>=g.value.min&&C.value<=g.value.max?"#67C23A":"#F56C6C",ie=()=>{const i=f.value.max-f.value.min,e=(b.value-f.value.min)/i;return Math.max(0,Math.min(100,e*100))},re=()=>b.value>=f.value.min&&b.value<=f.value.max?"#67C23A":"#F56C6C",ue=()=>{const i=x.value.max-x.value.min,e=(k.value-x.value.min)/i;return Math.max(0,Math.min(100,e*100))},de=()=>k.value>=x.value.min&&k.value<=x.value.max?"#67C23A":"#F56C6C";let R=null;return Ce(()=>{R=setInterval(()=>{C.value+=(Math.random()-.5)*2,b.value+=(Math.random()-.5)*.001,k.value+=(Math.random()-.5)*.01,M.value>0&&M.value--},1e3)}),be(()=>{R&&clearInterval(R)}),(i,e)=>{const a=d("el-icon"),n=d("el-button"),z=d("el-col"),ce=d("el-tag"),T=d("el-progress"),me=d("el-alert"),pe=d("el-row"),B=d("el-input"),I=d("el-form-item"),V=d("el-checkbox"),ve=d("el-checkbox-group"),_e=d("el-form"),ge=d("el-dialog");return m(),_("div",je,[t("div",Ge,[t("div",Qe,[t("h2",null,"炉次 "+o(D.value)+" - "+o(E.value),1),t("div",We,[t("span",null,"钢种："+o(O.value),1),t("span",null,"开始时间："+o($.value),1),t("span",null,"预计结束："+o(N.value),1)])]),t("div",qe,[l(n,{type:"primary",onClick:Z},{default:s(()=>[l(a,null,{default:s(()=>[l(y(Pe))]),_:1}),e[5]||(e[5]=c(" 取样 ",-1))]),_:1}),l(n,{type:"success",onClick:K},{default:s(()=>[...e[6]||(e[6]=[c(" 测温 ",-1)])]),_:1}),l(n,{type:"warning",onClick:X},{default:s(()=>[l(a,null,{default:s(()=>[l(y(De))]),_:1}),e[7]||(e[7]=c(" 加料向导 ",-1))]),_:1})])]),l(pe,{gutter:20},{default:s(()=>[l(z,{span:16},{default:s(()=>[t("div",He,[e[8]||(e[8]=t("h3",null,"吹炼时间轴",-1)),t("div",Je,[(m(!0),_(ke,null,Me(U.value,(r,fe)=>(m(),_("div",{key:fe,class:Ae(["timeline-item",{active:r.active,completed:r.completed}])},[t("div",Ze,[r.completed?(m(),S(a,{key:0},{default:s(()=>[l(y($e))]),_:1})):r.active?(m(),S(a,{key:1},{default:s(()=>[l(y(Ne))]),_:1})):(m(),S(a,{key:2},{default:s(()=>[l(y(Ue))]),_:1}))]),t("div",Ke,[t("div",Xe,o(r.title),1),t("div",Ye,o(r.time),1),r.details?(m(),_("div",et,o(r.details),1)):F("",!0)])],2))),128))])]),t("div",tt,[e[9]||(e[9]=t("h3",null,"实时监测曲线",-1)),l(y(Be),{option:J.value,style:{height:"400px"}},null,8,["option"])])]),_:1}),l(z,{span:8},{default:s(()=>[t("div",lt,[e[17]||(e[17]=t("h3",null,"AI智能建议",-1)),p.value?(m(),_("div",st,[t("div",at,[t("span",nt,o(p.value.title),1),l(ce,{type:ae(p.value.confidence),size:"small"},{default:s(()=>[c(" 置信度: "+o(p.value.confidence)+"% ",1)]),_:1},8,["type"])]),t("div",ot,[t("p",null,o(p.value.description),1),t("div",it,[t("div",rt,[e[10]||(e[10]=t("span",{class:"label"},"建议内容：",-1)),t("span",null,o(p.value.content),1)]),t("div",ut,[e[11]||(e[11]=t("span",{class:"label"},"预期效果：",-1)),t("span",null,o(p.value.expectedEffect),1)]),t("div",dt,[e[12]||(e[12]=t("span",{class:"label"},"预计收益：",-1)),t("span",ct,o(p.value.expectedProfit)+"元",1)])])]),t("div",mt,[l(n,{type:"primary",size:"small",onClick:te},{default:s(()=>[...e[13]||(e[13]=[c(" 执行 ",-1)])]),_:1}),l(n,{size:"small",onClick:le},{default:s(()=>[...e[14]||(e[14]=[c(" 部分执行 ",-1)])]),_:1}),l(n,{type:"danger",size:"small",onClick:se},{default:s(()=>[...e[15]||(e[15]=[c(" 拒绝 ",-1)])]),_:1})])])):(m(),_("div",pt,[l(a,null,{default:s(()=>[l(y(Ee))]),_:1}),e[16]||(e[16]=t("span",null,"暂无AI建议",-1))]))]),t("div",vt,[e[21]||(e[21]=t("h3",null,"目标窗口",-1)),t("div",_t,[e[18]||(e[18]=t("div",{class:"target-label"},"温度目标",-1)),t("div",gt,[t("span",null,o(g.value.min)+"°C - "+o(g.value.max)+"°C",1),t("span",ft,"当前: "+o(C.value)+"°C",1)]),l(T,{percentage:ne(),color:oe(),"show-text":!1},null,8,["percentage","color"])]),t("div",xt,[e[19]||(e[19]=t("div",{class:"target-label"},"碳含量目标",-1)),t("div",yt,[t("span",null,o(f.value.min)+"% - "+o(f.value.max)+"%",1),t("span",ht,"当前: "+o(b.value)+"%",1)]),l(T,{percentage:ie(),color:re(),"show-text":!1},null,8,["percentage","color"])]),t("div",Ct,[e[20]||(e[20]=t("div",{class:"target-label"},"渣碱度目标",-1)),t("div",bt,[t("span",null,o(x.value.min)+" - "+o(x.value.max),1),t("span",kt,"当前: "+o(k.value),1)]),l(T,{percentage:ue(),color:de(),"show-text":!1},null,8,["percentage","color"])])]),M.value>0?(m(),_("div",Mt,[l(me,{title:`${M.value}分钟后复测`,type:"warning",closable:!1,"show-icon":""},null,8,["title"])])):F("",!0)]),_:1})]),_:1}),l(ge,{modelValue:A.value,"onUpdate:modelValue":e[4]||(e[4]=r=>A.value=r),title:"加料向导",width:"600px"},{footer:s(()=>[l(n,{onClick:e[3]||(e[3]=r=>A.value=!1)},{default:s(()=>[...e[27]||(e[27]=[c("取消",-1)])]),_:1}),l(n,{type:"primary",onClick:ee},{default:s(()=>[...e[28]||(e[28]=[c("执行方案",-1)])]),_:1})]),default:s(()=>[t("div",At,[l(_e,{model:v,"label-width":"120px"},{default:s(()=>[l(I,{label:"当前库存"},{default:s(()=>[l(B,{modelValue:v.limeStock,"onUpdate:modelValue":e[0]||(e[0]=r=>v.limeStock=r),placeholder:"石灰库存(kg)"},{append:s(()=>[...e[22]||(e[22]=[c("kg",-1)])]),_:1},8,["modelValue"])]),_:1}),l(I,{label:"目标渣碱度"},{default:s(()=>[l(B,{modelValue:v.targetR,"onUpdate:modelValue":e[1]||(e[1]=r=>v.targetR=r),placeholder:"目标R值"},null,8,["modelValue"])]),_:1}),l(I,{label:"约束条件"},{default:s(()=>[l(ve,{modelValue:v.constraints,"onUpdate:modelValue":e[2]||(e[2]=r=>v.constraints=r)},{default:s(()=>[l(V,{label:"lime"},{default:s(()=>[...e[23]||(e[23]=[c("石灰用量限制",-1)])]),_:1}),l(V,{label:"fluorite"},{default:s(()=>[...e[24]||(e[24]=[c("萤石用量限制",-1)])]),_:1}),l(V,{label:"cost"},{default:s(()=>[...e[25]||(e[25]=[c("成本控制",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),w.value?(m(),_("div",wt,[e[26]||(e[26]=t("h4",null,"推荐配比方案",-1)),t("div",Rt,[t("span",null,"石灰："+o(w.value.lime)+"kg",1),t("span",null,"萤石："+o(w.value.fluorite)+"kg",1),t("span",null,"预计R值："+o(w.value.expectedR),1)])])):F("",!0)])]),_:1},8,["modelValue"])])}}},Bt=Le(Tt,[["__scopeId","data-v-6ab190f9"]]);export{Bt as default};
